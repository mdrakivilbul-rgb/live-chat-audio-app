<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Chat & Audio Call App</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Loading Chat App...</p>
        </div>
    </div>

    <!-- Authentication Screen -->
    <div id="auth-screen" class="auth-screen">
        <div class="auth-container">
            <div class="auth-header">
                <h1><i class="fas fa-comments"></i> Live Chat</h1>
                <p>Connect with friends instantly</p>
            </div>

            <!-- Login Form -->
            <div id="login-form" class="auth-form active">
                <h2>Welcome Back</h2>
                <form id="loginForm">
                    <div class="input-group">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="loginEmail" placeholder="Email" required>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="loginPassword" placeholder="Password" required>
                        <button type="button" class="toggle-password" onclick="togglePassword('loginPassword')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <button type="submit" class="auth-btn">
                        <i class="fas fa-sign-in-alt"></i> Sign In
                    </button>
                </form>
                <p class="auth-switch">
                    Don't have an account? 
                    <a href="#" onclick="switchToRegister()">Sign up</a>
                </p>
            </div>

            <!-- Register Form -->
            <div id="register-form" class="auth-form">
                <h2>Create Account</h2>
                <form id="registerForm">
                    <div class="input-group">
                        <i class="fas fa-user"></i>
                        <input type="text" id="registerUsername" placeholder="Username" required>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="registerEmail" placeholder="Email" required>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="registerPassword" placeholder="Password" required>
                        <button type="button" class="toggle-password" onclick="togglePassword('registerPassword')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <button type="submit" class="auth-btn">
                        <i class="fas fa-user-plus"></i> Sign Up
                    </button>
                </form>
                <p class="auth-switch">
                    Already have an account? 
                    <a href="#" onclick="switchToLogin()">Sign in</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Main Chat Application -->
    <div id="chat-app" class="chat-app hidden">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="user-profile">
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="user-info">
                        <h3 id="currentUsername">User</h3>
                        <span class="status online">Online</span>
                    </div>
                </div>
                <div class="sidebar-actions">
                    <button class="action-btn" onclick="toggleTheme()" title="Toggle Theme">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="action-btn" onclick="showSettings()" title="Settings">
                        <i class="fas fa-cog"></i>
                    </button>
                    <button class="action-btn" onclick="logout()" title="Logout">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>

            <div class="sidebar-content">
                <div class="search-container">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="userSearch" placeholder="Search users...">
                    </div>
                </div>

                <div class="online-users">
                    <h4><i class="fas fa-circle text-green"></i> Online Users</h4>
                    <div id="onlineUsersList" class="users-list">
                        <!-- Online users will be populated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Area -->
        <div class="chat-area">
            <!-- Chat Header -->
            <div class="chat-header">
                <div class="chat-user-info">
                    <div class="chat-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="chat-user-details">
                        <h3 id="chatUsername">Select a user to start chatting</h3>
                        <span id="chatUserStatus" class="status">Offline</span>
                    </div>
                </div>
                <div class="chat-actions">
                    <button id="audioCallBtn" class="call-btn" onclick="startAudioCall()" title="Audio Call" disabled>
                        <i class="fas fa-phone"></i>
                    </button>
                    <button class="action-btn" onclick="clearChat()" title="Clear Chat">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>

            <!-- Messages Container -->
            <div class="messages-container" id="messagesContainer">
                <div class="welcome-message">
                    <i class="fas fa-comments"></i>
                    <h3>Welcome to Live Chat!</h3>
                    <p>Select a user from the sidebar to start messaging</p>
                </div>
            </div>

            <!-- Typing Indicator -->
            <div id="typingIndicator" class="typing-indicator hidden">
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <span id="typingText">Someone is typing...</span>
            </div>

            <!-- Message Input -->
            <div class="message-input-container">
                <div class="message-input">
                    <button class="attachment-btn" onclick="openFileUpload()" title="Attach File">
                        <i class="fas fa-paperclip"></i>
                    </button>
                    <input type="file" id="fileInput" style="display: none;" accept="image/*,application/pdf,.doc,.docx,.txt">
                    <input type="text" id="messageInput" placeholder="Type a message..." disabled>
                    <button class="emoji-btn" onclick="toggleEmojiPicker()" title="Emoji">
                        <i class="fas fa-smile"></i>
                    </button>
                    <button id="sendBtn" class="send-btn" onclick="sendMessage()" disabled>
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Audio Call Modal -->
    <div id="callModal" class="call-modal hidden">
        <div class="call-container">
            <div class="call-header">
                <h3 id="callTitle">Audio Call</h3>
                <span id="callStatus">Connecting...</span>
            </div>
            <div class="call-avatar">
                <i class="fas fa-user"></i>
                <h4 id="callUserName">User</h4>
            </div>
            <div class="call-timer">
                <span id="callTimer">00:00</span>
            </div>
            <div class="call-controls">
                <button id="muteBtn" class="call-control-btn" onclick="toggleMute()">
                    <i class="fas fa-microphone"></i>
                </button>
                <button id="endCallBtn" class="call-control-btn end-call" onclick="endCall()">
                    <i class="fas fa-phone-slash"></i>
                </button>
                <button id="speakerBtn" class="call-control-btn" onclick="toggleSpeaker()">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Incoming Call Modal -->
    <div id="incomingCallModal" class="call-modal hidden">
        <div class="call-container">
            <div class="call-header">
                <h3>Incoming Call</h3>
                <span>Audio Call</span>
            </div>
            <div class="call-avatar">
                <i class="fas fa-user"></i>
                <h4 id="incomingCallerName">User</h4>
            </div>
            <div class="incoming-call-controls">
                <button class="call-control-btn accept-call" onclick="acceptCall()">
                    <i class="fas fa-phone"></i>
                </button>
                <button class="call-control-btn reject-call" onclick="rejectCall()">
                    <i class="fas fa-phone-slash"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- Emoji Picker -->
    <div id="emojiPicker" class="emoji-picker hidden">
        <div class="emoji-grid">
            <span onclick="insertEmoji('😀')">😀</span>
            <span onclick="insertEmoji('😂')">😂</span>
            <span onclick="insertEmoji('😍')">😍</span>
            <span onclick="insertEmoji('🤔')">🤔</span>
            <span onclick="insertEmoji('😎')">😎</span>
            <span onclick="insertEmoji('😢')">😢</span>
            <span onclick="insertEmoji('😡')">😡</span>
            <span onclick="insertEmoji('👍')">👍</span>
            <span onclick="insertEmoji('👎')">👎</span>
            <span onclick="insertEmoji('❤️')">❤️</span>
            <span onclick="insertEmoji('🔥')">🔥</span>
            <span onclick="insertEmoji('⭐')">⭐</span>
        </div>
    </div>

    <!-- Audio Elements -->
    <audio id="localAudio" muted></audio>
    <audio id="remoteAudio"></audio>

    <!-- Scripts -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/app.js"></script>
    <script src="/js/webrtc.js"></script>
</body>
</html>

